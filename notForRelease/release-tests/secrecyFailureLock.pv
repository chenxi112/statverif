free c:channel.
free init:bitstring.

free k:bitstring[private].

query attacker(k).

cell s := (init,init).
cell t := (init,init).

let T =
lock (s);
lock (t);
read s as x;
read t as y;
s := k;
out (c, x);
out (c, y);
unlock (s);
unlock (t).



process T
