set verboseClauses=explained.

channel c.
free k:bitstring[private].

free beep:bitstring[private].

free one:bitstring.
free two:bitstring.
free three:bitstring.


fun enc(bitstring,bitstring):bitstring.

reduc forall m:bitstring,k:bitstring; dec(enc(m,k),k) = k.

query attacker(beep).

let A = out(c, enc(three,k)).

let B =
  in(c,xm:bitstring);
  if dec(xm,k) = two then out(c, one)
  else if dec(xm,k) = three then
  out(c, beep).

process A | B
